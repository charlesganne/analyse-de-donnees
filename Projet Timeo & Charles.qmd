---
title: "Projet de Timeo et Charles"
author: "Timeo Bossuet, Charles Ganne"
toc: true # Active une table des matieres automatique √† partir des titres markdown
format:
  html:
    html-math-method: katex # pour le rendu des formules math√©matiques. plus rapide que mathjax
    code-tools: true # boutons interactifs au dessus des blocs de code (copier le code, afficher/masquer)
    self-contained: true # le html g√©n√©r√© contient tout en un seul fichier
editor: visual
number_section: true # pour numeroter les sections
number_depth: 3 # pour adapter la profondeur de numerotation
toc-depth: 3 # pour g√©rer la profondeur de la table des mati√®res
toc-title: Table des mati√®res # Titre de la table des matieres
toc-location: left # sommaire √† gauche
execute: 
  echo: true # le code R s‚Äôaffiche dans le rendu final
cache: true # Quarto peut r√©utiliser des r√©sultats d√©j√† calcul√©s (plus rapide quand on recompile)
message: false
warning: false # messages/warnings cach√©s dans le livrable (sortie plus propre).
---

```{r}
#| echo: false 
# importation des librairies
library(ggplot2) # tracer des graphiques modernes 
library(dygraphs) # tracer des graphiques interactifs 
library(corrplot) # corr√©lations
library(gridExtra) # grilles de plots
library(scales)
library(forcats) # facteurs
library(reshape2) # /melt pour restructurer
library(BioStatR) # eta2
library(patchwork)

# ACP
library(FactoMineR)
library(factoextra)
```

# Chargement et d√©couverte du jeu de donn√©es

Ce projet a pour objectif de mener l'√©tude descriptive uni- et bi-dimensionnelle du jeu de donn√©es `DataGym3MIC` disponible sous Moodle. Voici les 6 premi√®res lignes du jeu de donn√©es pour s'en faire une preni√®re id√©e.

```{r}
#| echo: false

SalleDeSport <- read.table("DataGym3MIC.txt", header = T, stringsAsFactors = T) # charger le jeu de donn√©es
head(SalleDeSport) # voir les 6 premi√®res lignes
#dim(SalleDeSport) # voir les dimensions du jeu de donn√©es
#summary(SalleDeSport)
#str(SalleDeSport) # contr√¥le de la nature de chaque variable
```

Ce jeu de donn√©es comprend des mesures empiriques r√©alis√©es sur un √©chantillon de $973$ usagers d'une salle de sport. Chaque personne est d√©crite par les variables suivantes :

-   *gender* : Sexe du membre de la salle de sport (homme ou femme)
-   *weight* : Poids du membre en kilogrammes
-   *height* : Taille du membre en m√®tres
-   *duration* : Dur√©e de chaque s√©ance d'entra√Ænement en heures
-   *calories* : Total des calories br√ªl√©es au cours de chaque s√©ance
-   *fat* : Pourcentage de graisse corporelle du membre (appel√© "masse grasse")
-   *water* : Consommation quotidienne d'eau pendant les s√©ances d'entra√Ænement
-   *level* : Niveau d'exp√©rience : d√©butant (1), interm√©diaire (2) et expert (3)
-   *bmi* : Indice de masse corporelle (IMC), calcul√© √† partir de la taille et du poids

On observe que la variable *gender* est qualitative nominale et la variable *level* est qualitative ordinale. De plus, la variable *calories* est quantitative discr√®te. Les autres variables sont quantitatives continues. Il faut pr√©ciser √† R les variables qui doivent √™tre consid√©r√©es comme qualitatives. On utilise donc la fonction `as.factor()` sur les variables *gender* et *level* :

```{r}
SalleDeSport$gender <- factor(SalleDeSport$gender, levels=c("Male","Female"), labels = c("Homme", "Femme"))
SalleDeSport$level <- factor(SalleDeSport$level, levels=c("1","2","3"), labels=c("D√©butant","Interm√©diaire","Expert"), ordered=TRUE)
```

## Analyse unidimentionnelle

On commence par √©tudier chaque variable individuellement.

### Variables quantitatives

Pour chaque variable quantitative, on examine des statistiques descriptives (moyenne, m√©diane, quartiles, etc.). On trace chaque boxplot, violinplot et histogramme.

#### Poids (weight)

Le boxplot montre une m√©diane de 70 kg, avec une dispersion notable (la moiti√© des individus se situe entre 58 et 86 kg). On observe des valeurs atypiques √©lev√©es (points au-dessus de \~125‚Äì130 kg). L‚Äôhistogramme confirme une distribution asym√©trique √† droite : beaucoup d‚Äôindividus entre \~50 et 85 kg avec un maximum de fr√©quence autour de 60‚Äì70 kg. On observe une queue √† droite marqu√©e, correspondant √† des individus plus lourds (au-del√† de 100 kg), d√©j√† visibles comme valeurs atypiques/outliers sur le boxplot. La distribution n‚Äôest donc pas strictement gaussienne. Les 30 bins permettent de bien faire appara√Ætre la queue √† droite sans trop lisser la distribution. Un nombre plus faible masquerait les variations dans la zone centrale.

```{r}
#| echo: false
# 1) Violin + boxplot
p_violin_box <- ggplot(SalleDeSport, aes(x = "", y = weight)) +
  geom_violin(fill = "#9ECAE1", alpha = 0.8, trim = FALSE) +
  geom_boxplot(width = 0.12, fill = "#3182BD", alpha = 0.8,
               outlier.alpha = 0.6) +
  theme_minimal() +
  labs(
    x = NULL,
    y = "Poids (kg)"
  ) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()
  )

# Calcul de la m√©diane
med_weight <- median(SalleDeSport$weight, na.rm = TRUE)

# 2) Histogramme avec m√©diane
p_hist_med <- ggplot(SalleDeSport, aes(x = weight)) +
  geom_histogram(
    bins = 30,
    fill = "#6BAED6",
    color = "black",
    alpha = 0.7
  ) +
  geom_vline(
    xintercept = med_weight,
    linetype = "dashed",
    linewidth = 1,
    color = "red"
  ) +
  theme_minimal() +
  labs(
    x = "Poids (kg)",
    y = "Effectif"
  )

# Affichage c√¥te √† c√¥te
(p_violin_box | p_hist_med) +
  plot_annotation(
    title = "Distribution du poids",
    theme = theme(
      plot.title = element_text(
        size = 16,
        face = "bold",
        hjust = 0.5
      )
    )
  )
```

#### Taille (height)

La m√©diane est proche de 1,70‚Äì1,72 m, avec un intervalle interquartile entre 1,62 et 1,80 m. Le boxplot ne met pas en √©vidence d'outliers. L'histogramme sugg√®re une distribution plut√¥t concentr√©e entre 1,60 et 1,80 m, avec deux petites "bosses" (distribution pas parfaitement en cloche, probablement li√©e au fait que hommes et femmes soient dans le m√™me jeu de donn√©es), mais sans valeurs extr√™mes dominantes. En tra√ßant les graphiques avec diff√©rents nombres de bins, on a remarqu√© que certaines configurations masquaient le double pic tandis que d'autres le faisait clairement appara√Ætre. On a donc choisi 19 bins pour qu'ils apparaissent sans trop montrer les petites variations autour.

```{r}
#| echo: false
# 1) Violin + boxplot
p_violin_box <- ggplot(SalleDeSport, aes(x = "", y = height)) +
  geom_violin(fill = "#9ECAE1", alpha = 0.8, trim = FALSE) +
  geom_boxplot(width = 0.12, fill = "#3182BD", alpha = 0.8,
               outlier.alpha = 0.6) +
  theme_minimal() +
  labs(
    x = NULL,
    y = "Taille (m)"
  ) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()
  )

# Calcul de la m√©diane
med_height <- median(SalleDeSport$height, na.rm = TRUE)

# 2) Histogramme avec m√©diane
p_hist_med <- ggplot(SalleDeSport, aes(x = height)) +
  geom_histogram(
    bins = 19,
    fill = "#6BAED6",
    color = "black",
    alpha = 0.7
  ) +
  geom_vline(
    xintercept = med_height,
    linetype = "dashed",
    linewidth = 1,
    color = "red"
  ) +
  theme_minimal() +
  labs(
    x = "Taille (m)",
    y = "Effectif"
  )

# Affichage c√¥te √† c√¥te
(p_violin_box | p_hist_med) +
  plot_annotation(
    title = "Distribution des tailles des adh√©rents",
    theme = theme(
      plot.title = element_text(
        size = 16,
        face = "bold",
        hjust = 0.5
      )
    )
  )
```

#### Dur√©e (duration)

La m√©diane est autour de 1,25 h, et la moiti√© des s√©ances se situe approximativement entre \~1,05 et \~1,45 h. Les dur√©es extr√™mes vont d'environ 0,5 h √† 2 h. L'histogramme montre une concentration nette entre 1 h et 1,5 h, avec quelques s√©ances plus courtes et plus longues. √áa pourrait par exemple √™tre une recommandation de la salle de sport de faire une s√©ance courte, deux s√©ances moyennes et une s√©ance longue par semaine. Les 30 bins sont pertinentes car elles permettent de bien visualiser le pic entre 1h et 1,5 h sans trop lisser.

```{r}
#| echo: false
# 1) Violin + boxplot
p_violin_box <- ggplot(SalleDeSport, aes(x = "", y = duration)) +
  geom_violin(fill = "#9ECAE1", alpha = 0.8, trim = FALSE) +
  geom_boxplot(width = 0.12, fill = "#3182BD", alpha = 0.8,
               outlier.alpha = 0.6) +
  theme_minimal() +
  labs(
    x = NULL,
    y = "Dur√©e (h)"
  ) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()
  )

# Calcul de la m√©diane
med_duration <- median(SalleDeSport$duration, na.rm = TRUE)

# 2) Histogramme avec m√©diane
p_hist_med <- ggplot(SalleDeSport, aes(x = duration)) +
  geom_histogram(
    bins = 30,
    fill = "#6BAED6",
    color = "black",
    alpha = 0.7
  ) +
  geom_vline(
    xintercept = med_duration,
    linetype = "dashed",
    linewidth = 1,
    color = "red"
  ) +
  theme_minimal() +
  labs(
    x = "Dur√©e (h)",
    y = "Effectif"
  )

# Affichage c√¥te √† c√¥te
(p_violin_box | p_hist_med) +
  plot_annotation(
    title = "Distribution des dur√©es des s√©ances",
    theme = theme(
      plot.title = element_text(
        size = 16,
        face = "bold",
        hjust = 0.5
      )
    )
  )
```

#### Calories (calories)

Le boxplot indique une m√©diane proche de 900 kcal, avec un intervalle interquartile d'environ 750 √† 1100 kcal. On voit plusieurs valeurs atypiques √©lev√©es (au-del√† de 1600/1750 kcal), ce qui indique des s√©ances exceptionnellement √©nergivores. Cette structure est coh√©rente avec une distribution asym√©trique √† droite : des s√©ances "standard", et quelques s√©ances tr√®s intenses. Les 30 bins sont adapt√©s ici, ils r√©v√®lent la forme globale, tout en conservant la visibilit√© de la queue √† droite. Un nombre plus faible masquerait les extr√™mes.

```{r}
#| echo: false
# 1) Violin + boxplot
p_violin_box <- ggplot(SalleDeSport, aes(x = "", y = calories)) +
  geom_violin(fill = "#9ECAE1", alpha = 0.8, trim = FALSE) +
  geom_boxplot(width = 0.12, fill = "#3182BD", alpha = 0.8,
               outlier.alpha = 0.6) +
  theme_minimal() +
  labs(
    x = NULL,
    y = "Calories (kcal)"
  ) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()
  )

# Calcul de la m√©diane
med_calories <- median(SalleDeSport$calories, na.rm = TRUE)

# 2) Histogramme avec m√©diane
p_hist_med <- ggplot(SalleDeSport, aes(x = calories)) +
  geom_histogram(
    bins = 30,
    fill = "#6BAED6",
    color = "black",
    alpha = 0.7
  ) +
  geom_vline(
    xintercept = med_calories,
    linetype = "dashed",
    linewidth = 1,
    color = "red"
  ) +
  theme_minimal() +
  labs(
    x = "Calories (kcal)",
    y = "Effectif"
  )

# Affichage c√¥te √† c√¥te
(p_violin_box | p_hist_med) +
  plot_annotation(
    title = "Calories brul√©es pendant les seances",
    theme = theme(
      plot.title = element_text(
        size = 16,
        face = "bold",
        hjust = 0.5
      )
    )
  )
```

#### Masse grasse (fat)

La m√©diane est autour de 26%, avec la majorit√© des valeurs entre 21% et 29%. L'√©tendue va approximativement de 10% √† 35%. Le boxplot ne montre pas de points atypiques extr√™mes ; l'ensemble semble relativement homog√®ne, avec une dispersion mod√©r√©e. L'histogramme semble l√©g√®rement multimodal, ce qui peut refl√©ter des diff√©rences physiologiques (genres ou niveaux). Les 20 bins sont acceptables, en avoir plus n'apporte pas plus d'informations.

```{r}
#| echo: false
# 1) Violin + boxplot
p_violin_box <- ggplot(SalleDeSport, aes(x = "", y = fat)) +
  geom_violin(fill = "#9ECAE1", alpha = 0.8, trim = FALSE) +
  geom_boxplot(width = 0.12, fill = "#3182BD", alpha = 0.8,
               outlier.alpha = 0.6) +
  theme_minimal() +
  labs(
    x = NULL,
    y = "masse grasse (%)"
  ) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()
  )

# Calcul de la m√©diane
med_fat <- median(SalleDeSport$fat, na.rm = TRUE)

# 2) Histogramme avec m√©diane
p_hist_med <- ggplot(SalleDeSport, aes(x = fat)) +
  geom_histogram(
    bins = 20,
    fill = "#6BAED6",
    color = "black",
    alpha = 0.7
  ) +
  geom_vline(
    xintercept = med_fat,
    linetype = "dashed",
    linewidth = 1,
    color = "red"
  ) +
  theme_minimal() +
  labs(
    x = "masse grasse (%)",
    y = "Effectif"
  )

# Affichage c√¥te √† c√¥te
(p_violin_box | p_hist_med) +
  plot_annotation(
    title = "Distribution du masse grasse des adh√©rents",
    theme = theme(
      plot.title = element_text(
        size = 16,
        face = "bold",
        hjust = 0.5
      )
    )
  )
```

#### Eau (water)

La m√©diane est autour de 2,6 L, et l'intervalle interquartile va de 2,2 √† 3,1 L. L'√©tendue est d'environ 1,5 √† 3,7 L. La distribution para√Æt assez concentr√©e autour de 2‚Äì3 L, sans valeurs extr√™mes marquantes. Toutefois on remarque des pics marqu√©s autour de certaines valeurs (notamment 2,7 L et 3,5 L), sugg√©rant des valeurs arrondies ou/et des comportements standardis√©s (bouteilles, recommandation de cette salle de sport).

```{r}
#| echo: false
# 1) Violin + boxplot
p_violin_box <- ggplot(SalleDeSport, aes(x = "", y = water)) +
  geom_violin(fill = "#9ECAE1", alpha = 0.8, trim = FALSE) +
  geom_boxplot(width = 0.12, fill = "#3182BD", alpha = 0.8,
               outlier.alpha = 0.6) +
  theme_minimal() +
  labs(
    x = NULL,
    y = "Eau (L)"
  ) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()
  )

# Calcul de la m√©diane
med_water <- median(SalleDeSport$water, na.rm = TRUE)

# 2) Histogramme avec m√©diane
p_hist_med <- ggplot(SalleDeSport, aes(x = water)) +
  geom_histogram(
    bins = 25,
    fill = "#6BAED6",
    color = "black",
    alpha = 0.7
  ) +
  geom_vline(
    xintercept = med_water,
    linetype = "dashed",
    linewidth = 1,
    color = "red"
  ) +
  theme_minimal() +
  labs(
    x = "Eau (L))",
    y = "Effectif"
  )

# Affichage c√¥te √† c√¥te
(p_violin_box | p_hist_med) +
  plot_annotation(
    title = "Distribution des consommations d'eau des adh√©rents",
    theme = theme(
      plot.title = element_text(
        size = 16,
        face = "bold",
        hjust = 0.5
      )
    )
  )
```

#### IMC (bmi)

On observe une m√©diane de 24, avec la moiti√© des individus entre 20 et 28. En revanche, on observe de nombreux outliers √©lev√©s (au-del√† de 40 et jusqu'√† 50), ce qui traduit une forte asym√©trie √† droite : la majorit√© des individus est dans une zone "classique", mais une minorit√© pr√©sente des IMC tr√®s √©lev√©s. Cette queue droite importante confirme la pr√©sence d'individus en surpoids ou ob√©sit√©, d√©j√† visible sur le boxplot via de nombreux outliers. Cela rejoint les graphiques sur les poids o√π on avait remarqu√© d√©j√† la pr√©sence d'outlier avec des individus bien au del√† de 100kg.

```{r}
#| echo: false
# 1) Violin + boxplot
p_violin_box <- ggplot(SalleDeSport, aes(x = "", y = bmi)) +
  geom_violin(fill = "#9ECAE1", alpha = 0.8, trim = FALSE) +
  geom_boxplot(width = 0.12, fill = "#3182BD", alpha = 0.8,
               outlier.alpha = 0.6) +
  theme_minimal() +
  labs(
    x = NULL,
    y = "Indice de Masse Corporelle"
  ) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()
  )

# Calcul de la m√©diane
med_bmi <- median(SalleDeSport$bmi, na.rm = TRUE)

# 2) Histogramme avec m√©diane
p_hist_med <- ggplot(SalleDeSport, aes(x = bmi)) +
  geom_histogram(
    bins = 30,
    fill = "#6BAED6",
    color = "black",
    alpha = 0.7
  ) +
  geom_vline(
    xintercept = med_bmi,
    linetype = "dashed",
    linewidth = 1,
    color = "red"
  ) +
  theme_minimal() +
  labs(
    x = "IMC",
    y = "Effectif"
  )

# Affichage c√¥te √† c√¥te
(p_violin_box | p_hist_med) +
  plot_annotation(
    title = "Distribution des IMC des adh√©rents",
    theme = theme(
      plot.title = element_text(
        size = 16,
        face = "bold",
        hjust = 0.5
      )
    )
  )
```

### Variables qualitatives

√âtudions √† pr√©sent les distributions des variables qualitatives gender et level. On visualise ces r√©partitions avec des diagrammes en barres.

#### Le genre

```{r}
#| echo: false
ggplot(SalleDeSport, aes(x=gender, fill=gender)) +
geom_bar(alpha=0.8) +
scale_fill_manual(values=c("#4C72B0","#DD8452")) +
labs(title="Effectif par genre", x="Genre", y="Nombre d'individus") +
theme_minimal() + theme(legend.position="none")
```

Le diagramme en barres montre une r√©partition relativement √©quilibr√©e entre hommes et femmes, avec une l√©g√®re majorit√© d'hommes dans l'√©chantillon. Cette distribution sugg√®re une population globalement mixte, ce qui limite le risque de biais li√© √† une surrepr√©sentation marqu√©e d'un genre.

#### Le niveau

```{r}
#| echo: false
ggplot(SalleDeSport, aes(x=level, fill=level)) +
geom_bar(alpha=0.8) +
scale_fill_viridis_d(option = "C") +
labs(title="Effectif par niveau d'exp√©rience", x="Niveau", y="Nombre d'individus") +
theme_minimal() + theme(legend.position="none")
```

La r√©partition par niveau d'exp√©rience met en √©vidence une majorit√© d'individus de niveau interm√©diaire et de d√©butants. Les experts constituent le groupe le moins repr√©sent√©. Cette structure est coh√©rente avec un contexte de pratique sportive, o√π les niveaux interm√©diaires sont g√©n√©ralement les plus fr√©quents, tandis que les niveaux experts restent plus rares.

Ces distributions marginales fournissent un premier aper√ßu de la structure de l'√©chantillon. Elles serviront de r√©f√©rence pour l'analyse bidimensionnelle, notamment afin d'interpr√©ter correctement les comparaisons entre groupes.

## Analyse bidimensionnelle

### Corr√©lations entre variables quantitatives

On explore √† pr√©sent les relations entre les variables quantitatives avec des matrices de corr√©lations.

```{r}
#| echo: false

variables_quantitatives <- c("calories","water","duration","weight","bmi","height","fat")
corr_matrix <- cor(SalleDeSport[, variables_quantitatives])
corrplot(corr_matrix, method="ellipse", addCoef.col="black", tl.col="black", tl.srt=45, 
         title = paste("Matrice de corr√©lation"), 
         mar = c(0, 0, 2, 0))

# Fonction pour corr√©lation
cor_mat_safe <- function(df) {
  df <- df[, intersect(variables_quantitatives, names(df)), drop = FALSE]
  for (v in names(df)) df[[v]] <- suppressWarnings(as.numeric(df[[v]]))
  keep <- sapply(df, function(x) sum(!is.na(x)) >= 2 && sd(x, na.rm = TRUE) > 0)
  df <- df[, keep, drop = FALSE]
  if (ncol(df) < 2) return(NULL)
  cor(df, use = "pairwise.complete.obs", method = "pearson")
}

# Genres pr√©sents
genders <- unique(na.omit(SalleDeSport$gender))

# Boucle d'affichage
for (g in genders) {

  d <- SalleDeSport[SalleDeSport$gender == g, ]
  C <- cor_mat_safe(d)

  if (!is.null(C)) {
    corrplot(
      C,
      method = "ellipse",
      type = "full",
      addCoef.col = "black",
      tl.col = "black",
      tl.srt = 45,
      title = paste("Matrice de corr√©lation -", g),
      mar = c(0, 0, 2, 0)
    )
  }
}


```

On observe d'abord une corr√©lation positive entre le poids et la taille, les individus plus grands auraient tendance √† √™tre plus lourds. L'IMC, d√©fini √† partir du poids et de la taille, est logiquement tr√®s fortement corr√©l√© au poids. En revanche, sa corr√©lation avec la taille appara√Æt faible et l√©g√®rement n√©gative dans l'√©chantillon global. Lorsque l'analyse est men√©e s√©par√©ment chez les hommes et les femmes, cette corr√©lation n√©gative devient plus marqu√©e, ce qui est plus coh√©rent avec la formule de calcul de l'IMC et sugg√®re que l'effet de la taille est en partie masqu√© dans l'analyse globale. De plus, la corr√©lation entre poids et taille dispara√Æt compl√®tement lorsqu'on s√©pare hommes et femmes.

La relation entre la dur√©e des s√©ances et les calories br√ªl√©es est particuli√®rement forte, ce qui confirme que la d√©pense √©nerg√©tique d√©pend avant tout du temps consacr√© √† l'effort. La consommation d'eau est √©galement positivement li√©e √† la dur√©e et aux calories, bien que de mani√®re plus mod√©r√©e, traduisant des comportements d'hydratation variables d'un individu √† l'autre. Ces relations restent globalement stables lorsque l'on distingue les hommes et les femmes, ce qui indique des m√©canismes communs ind√©pendants du genre.

Le masse grasse se distingue par des corr√©lations n√©gatives marqu√©es avec la dur√©e des s√©ances, les calories br√ªl√©es et la consommation d'eau. Cela sugg√®re que les individus pr√©sentant un pourcentage de masse grasse plus √©lev√© ont tendance √† r√©aliser des s√©ances plus courtes et moins intenses, accompagn√©es d'une hydratation plus faible. √Ä l'inverse, les variables morphologiques telles que le poids et la taille ne sont pas li√©es aux indicateurs de performance sportive consid√©r√©s ici. Cette dissociation indique que, dans ce jeu de donn√©es et avec ces variables, la morphologie seule n'explique pas directement les performances, qui semblent davantage d√©pendre de l'effort fourni et de la composition corporelle.

Enfin, il est √©tonnant de voir que le masse grasse n'est pas corr√©l√© au poids ou √† l'IMC. Cette variable n'augmente donc pas m√©caniquement avec le poids, surtout dans une population sportive o√π la masse musculaire peut repr√©senter une part importante du poids total. Cette observation avait d√©j√† √©t√© faire lors de l'exp√©rience super-size me. Le sujet n'avait pas prit beaucoup de poids mais √©tait quand m√™me devenu en tr√®s mauvaise sant√©, notamment √† cause de son masse grasse (et beaucoup d'autres troubles li√©s √† la junk-food).

Un nuage de points g√©n√©rique calories vs duration color√© par genre permet de visualiser ces effets :

### Variables quantitatives en fonction de variables qualitatives

Comparons les distributions des variables quantitatives selon les cat√©gories de gender et de level √† l'aide de boxplots.

```{r}
#| echo: false

for (v in variables_quantitatives) {

  p_gender <- ggplot(SalleDeSport, aes(x = gender, y = .data[[v]], fill = gender)) +
    geom_boxplot() +
    scale_fill_manual(values = c("#4C72B0", "#DD8452")) +
    theme_minimal() +
    labs(title = paste(v, "par genre"), x = "Genre", y = v) +
    theme(legend.position = "none")

  p_level <- ggplot(SalleDeSport, aes(x = level, y = .data[[v]], fill = level)) +
    geom_boxplot() +
    scale_fill_brewer(palette = "Greens") +
    theme_minimal() +
    labs(title = paste(v, "par niveau"), x = "Niveau", y = v) +
    theme(legend.position = "none")

  print((p_gender | p_level) +
          plot_annotation(title = paste("Boxplots de", v, "selon genre et niveau")))
}
```

Entre les hommes et les femmes, on observe une diff√©rence de poids notable. Celle-ci va de paire avec la taille. Bien que nous n'avions pas relev√© de corr√©lation entre ces deux variables en s√©parant par sexe, le coefficient √©tait tout de m√™me de 0.37 sur la matrice mixte. Ces trois variables sont donc li√©es mais il n'y a pas d'observation particuli√®re √† faire √† ce niveau l√†. La dur√©e des s√©ances et le nombre de calories d√©pens√©es ne semblent pas li√©es au sexe. Nous avions vu que ces deux variables √©taient fortement corr√©l√©es entre elles, d'o√π les observations similaires lorsqu'on les observe ind√©pendamment. On rel√®ve toutefois la pr√©sence d'outliers chez les deux genres pour la variable calories et non pour la dur√©e. Ainsi, certains individus consomment beaucoup plus de calories. Selon les corr√©lations √©tablies pr√©c√©demment, on s'attend √† ce que ces m√™mes individus aient des s√©ances plus longues et un masse grasse plus bas. Et en effet, sur les boxplot du masse grasse, nous retrouvons ces outliers. Une autre observation plus notable est que les femmes ont un masse grasse nettement plus √©lev√©. Il peut y avoir plusieurs explications √† cela, et le jeu de donn√©es n'inclue pas certaines variables potentiellement cl√© √† ce sujet telles que la maternit√© ou l'age. Toutefois, une recherche sur google scholar tend √† confirmer cette observation. Le graphique suivant, allant de paire avec la corr√©lation inverse entre la consommation d'eau et le masse grasse √©tablie pr√©c√©demment, montre que les femmes semblent consommer moins d'eau. On avais toutefois d√©j√† observ√© que les personnes avec un masse grasse plus √©lev√© consommaient moins d'eau. De plus, cette corr√©lation restait vraie quand on s√©parait les matrices par sexe, c'est donc le lien eau-fat plut√¥t que eau-genre que l'on gardera. Enfin, l'IMC par genre. On remarque la pr√©sence de certaines personnes en situation d'ob√©sit√© s√©v√®re et morbide seulement chez les hommes, tandis qu'il n'y a pas de femmes avec un IMC sup√©rieur √† 35. La tendance au sur-poids est globalement plus prononc√©e chez les hommes que chez les femmes. Cette tendance est inverse a celle observ√©e sur le masse grasse.

Sur le premier graphique, le poids ne semble pas li√© au niveau, car les 3 niveaux ont leur intervalle inter-quartile entre 57 et 87. Toutefois, il est notable que les experts ont un poids clairement born√© entre 55 et 90, ce qui n'est pas le cas des d√©butants et des interm√©diaires. Ainsi, une tendance se dessine tout de m√™me quand au poids qu'aurait un expert. La taille √©galement semble non li√©e au niveau. On remarque toutefois que l'intervalle semble s‚Äô√©largir quand le niveau augmente. Mais on avait observ√© sur le premier violin plot de la taille un double pic dans la distribution. Cela pourrait donc √™tre un biais r√©siduel d√ª au genre. On remarque une tendance claire et prononc√©e au niveau de la dur√©e des s√©ances. Les experts ont tous des s√©ances longues, tandis que les interm√©diaires font des s√©ances moins longues et les d√©butant encore moins. √âtant donn√© la corr√©lation forte entre la dur√©e des s√©ances et les calories d√©pens√©es, on retrouve cette m√™me tendance sur le graphique suivant, le niveau allant croissant avec les calories d√©pens√©es. Cette tendance semble moins prononc√©e pour la consommation d'eau. Elle l'est malgr√© tout, on la visualise simplement un peu moins parce que tout le monde consomme globalement des quantit√©s d'eau comparables. Toutefois, on remarque encore que les experts (on le sait d√©j√†, faisant des s√©ances plus longues et plus √©nergivores) consomment plus d'eau que les d√©butants et interm√©diaires. Cette tendance est toutefois li√©s aux deux pr√©c√©dentes, il n'y a pas de lien de causalit√© notable entre la consommation d'eau et l'expertise dans un sport. Le masse grasse quand √† lui fortement corr√©l√© √† l'expertise. Il semble m√™me se dessiner une condition n√©cessaire et suffisante car pas un seul adh√©rent avec un masse grasse entre 12 et 18 n'est d√©butant ou interm√©diaire, et tous les gens ayant un masse grasse dans cet intervalle sont class√©s experts. √Ä l'inverse, les gens ayant une masse grasse plus √©lev√©e (de 20 √† 35%) seront forc√©ment d√©butant ou interm√©diaire. Cette observation est tout √† fait coh√©rente avec ce qui se trouve dans la litt√©rature (Sedukin D. V. et al., 2025), (Duncan M. J. et al., 2016). On observe √©galement la non pr√©sence d'outliers, contrairement au graphique sur l'IMC. En effet, sur ce dernier on retrouve les outliers en situation d'ob√©sit√© grave que nous avions identifi√© pr√©c√©demment. Tandis que les experts ne sont que rarement en situation d'ob√©sit√©. En effet, un IMC de 35 est d√©j√† consid√©r√© comme extr√™me pour un expert. La boite est √©galement beaucoup plus fine, pla√ßant l'IMC d'un expert entre la fine fourchette de 23 √† 27 avec une tol√©rance beaucoup plus r√©duite que pour les d√©butants et interm√©diaires. Pour ces derniers, l'√©cart inter quartile est entre 20 et 30 avec une moustache s'√©tendant de 10 √† 43, ce qui inclut les situations de maigreur et plusieurs nuances d'ob√©sit√© et de sur-poids.

En conclusion, l'expertise se distingue par une masse grasse r√©duite (12-18 %). Bien que le genre influence la r√©partition des masses grasses et les extr√™mes de l'IMC, la performance reste dict√©e par la dur√©e des s√©ances et l'intensit√© de la d√©pense calorique. Ces r√©sultats valident la litt√©rature scientifique en confirmant que l'assiduit√© √† l'entra√Ænement est le principal levier pour optimiser sa sant√© physique.

faire eta ¬≤ si le temps \### Association quantitatives vs qualitatives ($\eta^2$)

Pour chaque variable quantitative, on calcule le rapport de corr√©lation $\eta^2$ vis-√†-vis de chaque variable qualitative (gender et level) √† l‚Äôaide de la fonction eta2() du package BioStatR.

```{r}
eta_gender <- sapply(variables_quantitatives, function(v) eta2(SalleDeSport[[v]], SalleDeSport$gender))
eta_level <- sapply(variables_quantitatives, function(v) eta2(SalleDeSport[[v]], SalleDeSport$level))
eta_tab <- data.frame(Variable = variables_quantitatives, Eta2_Gender = eta_gender, Eta2_Level = eta_level)
print(eta_tab)
```

Le tableau obtenu donne, pour chaque variable quantitive, la part de variance expliqu√©e par le genre ou par le niveau. Par exemple :

Une grande valeur de Œ∑¬≤ pour fat vs gender indiquerait que le pourcentage de masse grasse diff√®re significativement entre hommes et femmes (on s'y attend).

Une valeur √©lev√©e de Œ∑¬≤ pour duration vs level sugg√©rerait que la dur√©e moyenne de s√©ance varie selon l'exp√©rience (√©ventuellement les d√©butants s‚Äôentra√Ænent moins longtemps que les experts, ou vice versa).

Des valeurs proches de 0 (pour water vs gender, par exemple) signifieraient une absence de lien fort.

\[√Ä compl√©ter : interpr√©senter les valeurs sp√©cifiques d'Œ∑¬≤ et en tirer des conclusions sur quelles relations sont fortes\]

Variables qualitatives entre elles

Enfin, on examine l‚Äôassociation entre les deux variables qualitatives gender et level.

R√©daction Table de contingence

tab_genre_niveau \<- table(SalleDeSport$gender, SalleDeSport$level) tab_genre_niveau addmargins(tab_genre_niveau) \# ajoute les totaux lignes/colonnes

Profils-lignes et profils-colonnes

prop.table(tab_genre_niveau, 1) \# proportions par genre (lignes) prop.table(tab_genre_niveau, 2) \# proportions par niveau (colonnes)

Mosaic plot

mosaicplot(tab_genre_niveau, color=TRUE, main="Mosaic : Genre vs Niveau")

On obtient ainsi la table de contingence et les marges. Les profils-lignes (prop.table(...,1)) montrent la r√©partition proportionnelle des niveaux pour chaque genre : par exemple, chez les hommes, X% sont d√©butants, Y% interm√©diaires, Z% experts. Les profils-colonnes (prop.table(...,2)) indiquent la proportion d'hommes et de femmes parmi les d√©butants, etc. Le mosaic plot met en √©vidence visuellement ces proportions.

\[√Ä compl√©ter : commenter les r√©sultats. Par exemple, si la proportion d'hommes est plus grande parmi les experts que parmi les d√©butants, cela se traduirait par un d√©calage visible. Sinon, on constate une r√©partition uniforme, etc.\]

Conclusion partielle

En r√©sum√©, cette analyse descriptive montre les caract√©ristiques principales du jeu de donn√©es DataGym3MIC. La plupart des variables quantitatives ont une distribution unimodale sans valeurs aberrantes majeures. On observe des diff√©rences attendues entre les genres (par exemple poids/taille sup√©rieurs chez les hommes, pourcentage de graisse sup√©rieur chez les femmes). Le niveau d'exp√©rience semble √©galement associ√© √† certaines variables d'entra√Ænement (√† d√©tailler). Les repr√©sentations graphiques (histogrammes, boxplots, nuages de points, mosaic plots) sont adapt√©es pour visualiser ces distributions et relations.

La suite du rapport pourra compl√©ter l'interpr√©tation d√©taill√©e de chaque graphique produit, ainsi que l'exploration de relations plus fines entre les variables (test d'ind√©pendance entre qualitatives, analyse de covariance, etc.). Chaque choix de repr√©sentation a √©t√© justifi√© par le type de variable et l'int√©r√™t d'illustrer visuellement la distribution ou la relation √©tudi√©e.

Ces graphiques (√† ex√©cuter) montreront la r√©partition : par exemple, si les hommes repr√©sentent 55% et les femmes 45% de l'√©chantillon, ou si 50% sont d√©butants, 30% interm√©diaires, 20% experts. \[√Ä compl√©ter : indiquer les pourcentages exacts et observations principales sur ces distributions\]

## Analyse en composantes principales

L'analyse en composantes principales est une m√©thode qui consiste √† transformer des variables li√©es entre elles (corr√©l√©es) en nouvelles variables d√©corr√©l√©es les unes des autres. Ces nouvelles variables sont nomm√©es "composantes principales" ou axes principaux. Elle permet de r√©sumer l'information en r√©duisant le nombre de variables.

Dans l'ensemble, les variables √©tudi√©es d√©crivent : la morphologie (poids, taille, IMC, masse grasse) ainsi que l'intensit√© et la pratique sportive (dur√©e, calories br√ªl√©es, niveau, eau consomm√©e). On a d√©j√† vu par exemple que la dur√©e de la s√©ance et les calories d√©pens√©es √©taient fortement corr√©l√©. Idem pour le poids et l'IMC (ces deux donn√©es sont d'ailleurs redondantes car l'IMC est calcul√© en fonction du poid et de la taille). Les variables n‚Äôont pas la m√™me unit√© (kg, %, heures, calories, ...). On fait donc une ACP centr√©e r√©duite, sinon les calories ou le poids domineraient toutes les autres variables.

```{r}

# ACP centr√©e-r√©duite
res_pca <- PCA(
  SalleDeSport,
  scale.unit = TRUE,
  quali.sup = c(which(names(SalleDeSport)=="gender"),
                which(names(SalleDeSport)=="level")),
  graph = FALSE
)

# Valeurs propres (choix du nombre d‚Äôaxes)
#res_pca$eig
fviz_eig(res_pca, addlabels = TRUE)

```

Les deux premi√®res composantes principales expliquent 41.5% + 26.8% = 68,3 % de la variance totale, ce qui permet d√©j√† une repr√©sentation satisfaisante des donn√©es. La troisi√®me composante explique n√©anmoins 17,6 % de la variance. Elle n'est donc pas compl√®tement n√©gligeable. Ainsi, nous nous concentrerons principalement sur le premier plan factoriel (axes 1 et 2), tout en gardant √† l'esprit l'apport potentiel de la troisi√®me composante.

```{r}

# cercle des corr√©lations
fviz_pca_var(res_pca,
             repel = TRUE)

# matrice des corr√©lations
cor_3axes <- res_pca$var$cor[, 1:3, drop = FALSE]

corrplot(
  cor_3axes,
  method = "ellipse",
  addCoef.col = "black",
  number.cex = 0.8,
  tl.cex = 0.9
)

```

Dans un premier temps, on remarque que les fl√®ches des variables weight, duration, calories, water, bmi sont longues Ces variables sont donc bien repr√©sent√©es sur le plan factoriel. La fl√®che de height est plus proche du centre, elle est donc moins bien repr√©sent√©e par les deux premi√®res composantes principales.

L'axe des abscisse (Dim1, 41.5 %) est corr√©l√© plus fortement √† calories (0.80), duration (0.73), water (0.73) et fat (-0.83). Ainsi, cette composante principale rassemble les variables dur√©e, calories et water, qui traduisent de l'intensit√© d'un entrainement, et les oppose √† la variable masse grasse. C'est une observation que nous avions faite pr√©c√©demment, les personnes avec une masse grasse plus √©lev√©es font des s√©ances moins intenses.

L'axe des ordonn√©es est principalement corr√©l√© √† l'IMC et au poids, les deux fl√®ches sont tr√®s proches. Il est √©galement n√©gativement corr√©l√© √† la dur√©e et aux calories. Cela nous permet d'opposer la corpulence des individus et leur endurance.

Enfin, la troisi√®me composante principale est corr√©l√©e √† la taille et √† l'imc. Cela est coh√©rent car l'imc est calcul√© en fonction de la taille. De plus la taille est assez faiblement corr√©l√© aux deux premi√®res composantes principales (0.35 et 0.20). Son influence sur les performances sportives et la corpulence est donc limit√©e. Cela justifie que l'on ne garde que les 2 premi√®res composantes principales.

En conclusion, le premier axe oppose des profils √† forte intensit√© d'entra√Ænement √† des profils √† forte masse grasse. Le second axe traduit principalement des diff√©rences morphologiques li√©es au poids et √† l'IMC. La troisi√®me composante est surtout associ√©e √† la taille et apporte une information compl√©mentaire.

```{r}

# Graphique des individus
fviz_pca_ind(res_pca,
             geom = "point",
             habillage = "gender",
             addEllipses = TRUE)

# Autre lecture int√©ressante :
fviz_pca_ind(res_pca, col.ind = "cos2")






```

5Ô∏è‚É£ Comment interpr√©ter (exemples concrets) Axe 1 (exemple)

L‚Äôaxe 1 oppose des individus √† forte intensit√© sportive (dur√©e √©lev√©e, calories br√ªl√©es importantes, niveau √©lev√©) √† des individus moins actifs.

Axe 2 (exemple)

L‚Äôaxe 2 est principalement li√© √† la morphologie corporelle, opposant des profils √† IMC et masse grasse √©lev√©s √† des profils plus secs.

Variables qualitatives

Les hommes apparaissent majoritairement du c√¥t√© des valeurs √©lev√©es de calories br√ªl√©es, tandis que les femmes sont davantage associ√©es √† des pourcentages de masse grasse plus √©lev√©s.

(adapte selon TES r√©sultats)

6Ô∏è‚É£ ACP √† la main ou avec FactoMineR ? ‚úÖ Pour le rapport

üëâ FactoMineR uniquement

C‚Äôest :

standard acad√©mique,

lisible,

attendu par les correcteurs,

reproductible.

üß† ACP √† la main

√Ä faire seulement :

si demand√© explicitement,

ou en annexe p√©dagogique (rare).

Phrase parfaite :

Les calculs sont r√©alis√©s √† l‚Äôaide de la librairie FactoMineR, l‚Äôimpl√©mentation manuelle de l‚ÄôACP n‚Äô√©tant pas n√©cessaire dans un cadre d‚Äôanalyse exploratoire appliqu√©e.

On fait quelques geom plot pour commencer a essayer d'observer des trucs dans e jeu de donn√©es :

A l'aide de la fonction `eta2()` de la librairie `BioStatR`, calculez le rapport de corr√©lation $\eta^2$ entre chaque variable quantitative et chaque variable qualitative. Commentez.(toutes les combinaisons)

**Question :** Analysez la table de contingence entre les deux variables qualitatives **Type** et **Qualite** avec la commande `table()`. Ajoutez les effectifs marginaux avec la commande `addmargins()`.

```{r}
# A COMPLETER
```

**Question :** Calculez et repr√©sentez les profils-lignes √† l'aide des fonctions `prop.table(..., margin = ...)` et `mosaicplot`. Interpr√©tez les r√©sultats. Faites de m√™me avec les profils-colonnes.

```{r}
# A COMPLETER
```

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

You can add options to executable code like this

```{r}
#| echo: false
#| eval: false
2 * 2
```

The `echo: false` option disables the printing of code (only output is displayed).

# Bibliographie

-   Nom .P et al., ANN√âE, \[en ligne, consult√© le XX YYYYYYYY\] : lien
-   Sedukin D. V. et al., 2025, \[en ligne, consult√© le 29 D√©cembre\] : https://vpbim.com.ua/wp-content/uploads/2025/10/54.pdf
-   Duncan M. J. et al., 2016, \[en ligne, consult√© le 29 D√©cembre\] : https://www.tandfonline.com/doi/abs/10.1080/02640414.2016.1258483

Ceci est la premiere modificqtion de timeo