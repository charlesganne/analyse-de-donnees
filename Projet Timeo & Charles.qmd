---
title: "Projet de Timeo et Charles"
author: "Timeo Bossuet, Charles Ganne"
toc: true # Active une table des matieres automatique à partir des titres markdown
format:
  html:
    html-math-method: katex # pour le rendu des formules mathématiques. plus rapide que mathjax
    code-tools: true # boutons interactifs au dessus des blocs de code (copier le code, afficher/masquer)
    self-contained: true # le html généré contient tout en un seul fichier
editor: visual
number_section: true # pour numeroter les sections
number_depth: 3 # pour adapter la profondeur de numerotation
toc-depth: 3 # pour gérer la profondeur de la table des matières
toc-title: Table des matières # Titre de la table des matieres
toc-location: left # sommaire à gauche
execute: 
  echo: true # le code R s’affiche dans le rendu final
cache: true # Quarto peut réutiliser des résultats déjà calculés (plus rapide quand on recompile)
message: false
warning: false # messages/warnings cachés dans le livrable (sortie plus propre).
---

```{r}
#| echo: false 
#| error: false
#| warning: false
# importation des librairies
library(ggplot2) # tracer des graphiques modernes 
library(dygraphs) # tracer des graphiques interractifs 
library(corrplot) # corrélations
library(gridExtra) # grilles de plots
library(scales)
library(forcats) # facteurs
library(reshape2) # /melt pour restructurer
library(BioStatR) # eta2
library(patchwork)
```

# Chargement et découverte du jeu de données

Ce projet a pour objectif de mener l'étude descriptive uni- et bi-dimensionnelle du jeu de données `DataGym3MIC` disponible sous Moodle.

*Remarque : penser à enlever les "#\|eval: false" au fur et à mesure de l'avancement dans le projet pour avoir les résultats dans le compte-rendu final.*

```{r}
# options possibles (tout ça pour le compte rendu final)
#| echo: true #(#| echo: false) : inclure le code (ou pas)
#| eval: true #(#| eval: false) : évalue le code (ou pas)
#| warning: true #(#| warning: false) : affiche les warnings (ou pas)
#| message: true #(#| message: false) : affiche les messages (ou pas)

SalleDeSport <- read.table("DataGym3MIC.txt", header = T, stringsAsFactors = T) # charger le jeu de données
head(SalleDeSport) # voir les 6 premières lignes
dim(SalleDeSport) # voir les dimensions du jeu de données
summary(SalleDeSport)
str(SalleDeSport) # contrôle de la nature de chaque variable
```

Ce jeu de données comprend des mesures empiriques réalisées sur un échantillon de $973$ usagers d'une salle de sport. Chaque personne est décrite par les variables suivantes :

-   *gender* : Sexe du membre de la salle de sport (homme ou femme)
-   *weight* : Poids du membre en kilogrammes
-   *height* : Taille du membre en mètres
-   *duration* : Durée de chaque séance d’entraı̂nement en heures
-   *calories* : Total des calories brûlées au cours de chaque séance
-   *fat* : Pourcentage de graisse corporelle du membre
-   *water* : Consommation quotidienne d’eau pendant les séances d’entraı̂nement
-   *level* : Niveau d’expérience, de débutant (1) à expert (3)
-   *bmi* : Indice de masse corporelle (IMC), calculé à partir de la taille et du poids

En regardant le résultat de la fonction `str`, on observe que la variable *gender* est qualitative nominale et la variable *level* est qualitative ordinale. De plus, la variable *calories* est quantitative discrète et les autres sont quantitatives continues. Attention, il faut bien préciser à R les variables qui doivent être considérées comme qualitatives. On utilise donc la fonction `as.factor()` sur les variables *gender* et *level*.

```{r}
SalleDeSport$gender <- factor(SalleDeSport$gender, levels=c("Male","Female"), labels = c("Homme", "Femme"))
SalleDeSport$level <- factor(SalleDeSport$level, levels=c("1","2","3"), labels=c("Débutant","Intermédiaire","Expert"), ordered=TRUE)
```

## Analyse unidimentionnelle

On commence par étudier chaque variable individuellement.

### Variables quantitatives

Pour chaque variable quantitative, on examine des statistiques descriptives (moyenne, médiane, quartiles, etc.). On trace chaque boxplot, violinplot et histogramme.

#### Poids (weight)

Le boxplot montre une médiane de 70 kg, avec une dispersion notable (la moitié des individus se situe entre 58 et 86 kg). On observe des valeurs atypiques élevées (points au-dessus de ~125–130 kg). L’histogramme confirme une distribution asymétrique à droite : beaucoup d’individus entre ~50 et 85 kg avec un maximum de fréquence autour de 60–70 kg. On observe une queue à droite marquée, correspondant à des individus plus lourds (au-delà de 100 kg), déjà visibles comme valeurs atypiques/outliers sur le boxplot. La distribution n’est donc pas strictement gaussienne. Les 30 bins permettent de bien faire apparaître la queue à droite sans trop lisser la distribution. Un nombre plus faible masquerait les variations fines dans la zone centrale.

```{r}
# 1) Violin + boxplot
p_violin_box <- ggplot(SalleDeSport, aes(x = "", y = weight)) +
  geom_violin(fill = "#9ECAE1", alpha = 0.8, trim = FALSE) +
  geom_boxplot(width = 0.12, fill = "#3182BD", alpha = 0.8,
               outlier.alpha = 0.6) +
  theme_minimal() +
  labs(
    x = NULL,
    y = "Poids (kg)"
  ) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()
  )

# Calcul de la médiane
med_weight <- median(SalleDeSport$weight, na.rm = TRUE)

# 2) Histogramme avec médiane
p_hist_med <- ggplot(SalleDeSport, aes(x = weight)) +
  geom_histogram(
    bins = 30,
    fill = "#6BAED6",
    color = "black",
    alpha = 0.7
  ) +
  geom_vline(
    xintercept = med_weight,
    linetype = "dashed",
    linewidth = 1,
    color = "red"
  ) +
  theme_minimal() +
  labs(
    x = "Poids (kg)",
    y = "Effectif"
  )

# Affichage côte à côte
(p_violin_box | p_hist_med) +
  plot_annotation(
    title = "Distribution du poids",
    theme = theme(
      plot.title = element_text(
        size = 16,
        face = "bold",
        hjust = 0.5
      )
    )
  )
```

#### Taille (height)

La médiane est proche de 1,70–1,72 m, avec un intervalle interquartile autour de 1,62 à 1,80 m. Le boxplot ne met pas en évidence d’outliers marqués. L’histogramme suggère une distribution plutôt concentrée entre ~1,60 et ~1,80 m, avec deux petites "bosses" (distribution pas parfaitement en cloche, probablement liée à la coexistence de populations masculines et féminines), mais sans valeurs extrêmes dominantes. En traçant les graphiques avec différents nombres de bins, on a remarqué que certaines configurations masquaient le double pic tandis que d'autres le faisait clairement apparaître. On a donc choisi 19 bins pour qu'ils apparaissent sans trop montrer les microvariations autour.

```{r}
# 1) Violin + boxplot
p_violin_box <- ggplot(SalleDeSport, aes(x = "", y = height)) +
  geom_violin(fill = "#9ECAE1", alpha = 0.8, trim = FALSE) +
  geom_boxplot(width = 0.12, fill = "#3182BD", alpha = 0.8,
               outlier.alpha = 0.6) +
  theme_minimal() +
  labs(
    x = NULL,
    y = "Taille (m)"
  ) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()
  )

# Calcul de la médiane
med_height <- median(SalleDeSport$height, na.rm = TRUE)

# 2) Histogramme avec médiane
p_hist_med <- ggplot(SalleDeSport, aes(x = height)) +
  geom_histogram(
    bins = 19,
    fill = "#6BAED6",
    color = "black",
    alpha = 0.7
  ) +
  geom_vline(
    xintercept = med_height,
    linetype = "dashed",
    linewidth = 1,
    color = "red"
  ) +
  theme_minimal() +
  labs(
    x = "Taille (m)",
    y = "Effectif"
  )

# Affichage côte à côte
(p_violin_box | p_hist_med) +
  plot_annotation(
    title = "Distribution des tailles des adhérents",
    theme = theme(
      plot.title = element_text(
        size = 16,
        face = "bold",
        hjust = 0.5
      )
    )
  )
```

#### Durée (duration)

La médiane est autour de 1,25 h, et la moitié des séances se situe approximativement entre ~1,05 et ~1,45 h. Les durées extrêmes vont d’environ 0,5 h à 2 h. L’histogramme montre une concentration nette entre 1 h et 1,5 h, avec quelques séances plus courtes et plus longues : la variabilité est réelle mais reste dans une plage plausible. Ca pourrait par exemple être une recommandation de la salle de sport de faire une séance courte, deux séances moyennes et une séance longue par semaine. Les 30 bins sont pertinentes car la variable est bornée sur un intervalle court et continu. Elles permettent de bien visualiser les pics autour de 1 h–1,5 h sans sur-lissage.

```{r}
# 1) Violin + boxplot
p_violin_box <- ggplot(SalleDeSport, aes(x = "", y = duration)) +
  geom_violin(fill = "#9ECAE1", alpha = 0.8, trim = FALSE) +
  geom_boxplot(width = 0.12, fill = "#3182BD", alpha = 0.8,
               outlier.alpha = 0.6) +
  theme_minimal() +
  labs(
    x = NULL,
    y = "Durée (h)"
  ) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()
  )

# Calcul de la médiane
med_duration <- median(SalleDeSport$duration, na.rm = TRUE)

# 2) Histogramme avec médiane
p_hist_med <- ggplot(SalleDeSport, aes(x = duration)) +
  geom_histogram(
    bins = 30,
    fill = "#6BAED6",
    color = "black",
    alpha = 0.7
  ) +
  geom_vline(
    xintercept = med_duration,
    linetype = "dashed",
    linewidth = 1,
    color = "red"
  ) +
  theme_minimal() +
  labs(
    x = "Durée (h)",
    y = "Effectif"
  )

# Affichage côte à côte
(p_violin_box | p_hist_med) +
  plot_annotation(
    title = "Distribution des durées des séances",
    theme = theme(
      plot.title = element_text(
        size = 16,
        face = "bold",
        hjust = 0.5
      )
    )
  )
```

#### Calories (calories)

Le boxplot indique une médiane proche de 900 kcal, avec un intervalle interquartile d'environ 750 à 1100 kcal. On voit plusieurs valeurs atypiques élevées (au-delà de 1600/1750 kcal), ce qui indique des séances exceptionnellement énergivores, peut être que les niveaux experts ou les personnes plus grandes consomment plus d'énergie. Cette structure est cohérente avec une distribution asymétrique à droite : beaucoup de séances "standard", et quelques séances très intenses. L’histogramme n'est pas symétrique. Les 30 bins sont très bien adaptés ici, ils révèlent la forme globale, tout en conservant la visibilité de la queue à droite. Un nombre plus faible masquerait les extrêmes.

```{r}
# 1) Violin + boxplot
p_violin_box <- ggplot(SalleDeSport, aes(x = "", y = calories)) +
  geom_violin(fill = "#9ECAE1", alpha = 0.8, trim = FALSE) +
  geom_boxplot(width = 0.12, fill = "#3182BD", alpha = 0.8,
               outlier.alpha = 0.6) +
  theme_minimal() +
  labs(
    x = NULL,
    y = "Calories (kcal)"
  ) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()
  )

# Calcul de la médiane
med_calories <- median(SalleDeSport$calories, na.rm = TRUE)

# 2) Histogramme avec médiane
p_hist_med <- ggplot(SalleDeSport, aes(x = calories)) +
  geom_histogram(
    bins = 30,
    fill = "#6BAED6",
    color = "black",
    alpha = 0.7
  ) +
  geom_vline(
    xintercept = med_calories,
    linetype = "dashed",
    linewidth = 1,
    color = "red"
  ) +
  theme_minimal() +
  labs(
    x = "Calories (kcal)",
    y = "Effectif"
  )

# Affichage côte à côte
(p_violin_box | p_hist_med) +
  plot_annotation(
    title = "Calories brulées pendant les seances",
    theme = theme(
      plot.title = element_text(
        size = 16,
        face = "bold",
        hjust = 0.5
      )
    )
  )
```


#### Masse grasse (fat)

La médiane est autour de 26%, avec la majorité des valeurs entre 21% et 29%. L’étendue va approximativement de 10% à 35%. Le boxplot ne montre pas de points atypiques extrêmes ; l’ensemble semble relativement homogène, avec une dispersion modérée. L’histogramme semble légèrement multimodal, ce qui peut refléter des différences physiologiques (genres ou niveaux). Les 20 bins sont acceptables, en avoir plus n'apporte pas plus d'informations.

```{r}
# 1) Violin + boxplot
p_violin_box <- ggplot(SalleDeSport, aes(x = "", y = fat)) +
  geom_violin(fill = "#9ECAE1", alpha = 0.8, trim = FALSE) +
  geom_boxplot(width = 0.12, fill = "#3182BD", alpha = 0.8,
               outlier.alpha = 0.6) +
  theme_minimal() +
  labs(
    x = NULL,
    y = "Body fat (%)"
  ) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()
  )

# Calcul de la médiane
med_fat <- median(SalleDeSport$fat, na.rm = TRUE)

# 2) Histogramme avec médiane
p_hist_med <- ggplot(SalleDeSport, aes(x = fat)) +
  geom_histogram(
    bins = 20,
    fill = "#6BAED6",
    color = "black",
    alpha = 0.7
  ) +
  geom_vline(
    xintercept = med_fat,
    linetype = "dashed",
    linewidth = 1,
    color = "red"
  ) +
  theme_minimal() +
  labs(
    x = "Body fat (%)",
    y = "Effectif"
  )

# Affichage côte à côte
(p_violin_box | p_hist_med) +
  plot_annotation(
    title = "Distribution du body-fat des adhérents",
    theme = theme(
      plot.title = element_text(
        size = 16,
        face = "bold",
        hjust = 0.5
      )
    )
  )
```

#### Eau (water)

La médiane est autour de 2,6 L, et l’intervalle interquartile est de 2,2 à 3,1 L. L’étendue est d’environ 1,5 à 3,7 L. La distribution paraît assez concentrée autour de 2–3 L, sans valeurs extrêmes marquantes. Toutefois on remarque des pics marqués autour de certaines valeurs (notamment 2,7 L et 3,5 L), suggérant des valeurs arrondies ou/et des comportements standardisés (bouteilles, consignes).

```{r}
# 1) Violin + boxplot
p_violin_box <- ggplot(SalleDeSport, aes(x = "", y = water)) +
  geom_violin(fill = "#9ECAE1", alpha = 0.8, trim = FALSE) +
  geom_boxplot(width = 0.12, fill = "#3182BD", alpha = 0.8,
               outlier.alpha = 0.6) +
  theme_minimal() +
  labs(
    x = NULL,
    y = "Eau (L)"
  ) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()
  )

# Calcul de la médiane
med_water <- median(SalleDeSport$water, na.rm = TRUE)

# 2) Histogramme avec médiane
p_hist_med <- ggplot(SalleDeSport, aes(x = water)) +
  geom_histogram(
    bins = 25,
    fill = "#6BAED6",
    color = "black",
    alpha = 0.7
  ) +
  geom_vline(
    xintercept = med_water,
    linetype = "dashed",
    linewidth = 1,
    color = "red"
  ) +
  theme_minimal() +
  labs(
    x = "Eau (L))",
    y = "Effectif"
  )

# Affichage côte à côte
(p_violin_box | p_hist_med) +
  plot_annotation(
    title = "Distribution des consommations d'eau des adhérents",
    theme = theme(
      plot.title = element_text(
        size = 16,
        face = "bold",
        hjust = 0.5
      )
    )
  )
```

#### IMC (bmi)

On observe une médiane de 24, avec la moitié des individus entre 20 et 28. En revanche, on observe de nombreux outliers élevés (au-delà de 40 et jusqu’à 50), ce qui traduit une forte asymétrie à droite : la majorité des individus est dans une zone "classique", mais une minorité présente des IMC très élevés. Cette queue droite importante confirme la présence d'individus en surpoids ou obésité, déjà visible sur le boxplot via de nombreux outliers. Cela rejoint les graphiques sur les poids où on avait remarqué déjà la présence d'outlier avec des individus bien au delà de 100kg.

```{r}
# 1) Violin + boxplot
p_violin_box <- ggplot(SalleDeSport, aes(x = "", y = bmi)) +
  geom_violin(fill = "#9ECAE1", alpha = 0.8, trim = FALSE) +
  geom_boxplot(width = 0.12, fill = "#3182BD", alpha = 0.8,
               outlier.alpha = 0.6) +
  theme_minimal() +
  labs(
    x = NULL,
    y = "Indice de Masse Corporelle"
  ) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()
  )

# Calcul de la médiane
med_bmi <- median(SalleDeSport$bmi, na.rm = TRUE)

# 2) Histogramme avec médiane
p_hist_med <- ggplot(SalleDeSport, aes(x = bmi)) +
  geom_histogram(
    bins = 30,
    fill = "#6BAED6",
    color = "black",
    alpha = 0.7
  ) +
  geom_vline(
    xintercept = med_bmi,
    linetype = "dashed",
    linewidth = 1,
    color = "red"
  ) +
  theme_minimal() +
  labs(
    x = "IMC",
    y = "Effectif"
  )

# Affichage côte à côte
(p_violin_box | p_hist_med) +
  plot_annotation(
    title = "Distribution des IMC des adhérents",
    theme = theme(
      plot.title = element_text(
        size = 16,
        face = "bold",
        hjust = 0.5
      )
    )
  )
```

### Variables qualitatives

Étudions à présent les distributions des variables qualitatives gender et level. On visualise ces répartitions avec des diagrammes en barres.

#### Le genre

```{r}
ggplot(SalleDeSport, aes(x=gender, fill=gender)) +
geom_bar(alpha=0.8) +
scale_fill_manual(values=c("#4C72B0","#DD8452")) +
labs(title="Effectif par genre", x="Genre", y="Nombre d'individus") +
theme_minimal() + theme(legend.position="none")
```

Le diagramme en barres montre une répartition relativement équilibrée entre hommes et femmes, avec une légère majorité d’hommes dans l’échantillon. Cette distribution suggère une population globalement mixte, ce qui limite le risque de biais lié à une surreprésentation marquée d’un genre.

#### Le niveau

```{r}
ggplot(SalleDeSport, aes(x=level, fill=level)) +
geom_bar(alpha=0.8) +
scale_fill_viridis_d(option = "C") +
labs(title="Effectif par niveau d'expérience", x="Niveau", y="Nombre d'individus") +
theme_minimal() + theme(legend.position="none")
```

La répartition par niveau d’expérience met en évidence une majorité d’individus de niveau intermédiaire et de débutants. Les experts constituent le groupe le moins représenté. Cette structure est cohérente avec un contexte de pratique sportive, où les niveaux intermédiaires sont généralement les plus fréquents, tandis que les niveaux experts restent plus rares.

Ces distributions marginales fournissent un premier aperçu de la structure de l’échantillon. Elles serviront de référence pour l’analyse bidimensionnelle, notamment afin d’interpréter correctement les comparaisons entre groupes.

## Analyse bidimensionnelle

### Corrélations entre variables quantitatives

On explore à présent les relations entre les variables quantitatives avec des matrices de corrélations. 

```{r}
num_vars <- c("calories","water","duration","weight","bmi","height","fat")
corr_matrix <- cor(SalleDeSport[, num_vars])
corrplot(corr_matrix, method="ellipse", addCoef.col="black", tl.col="black", tl.srt=45, 
         title = paste("Matrice de corrélation"), 
         mar = c(0, 0, 2, 0))



# Variables quantitatives
vars_quant <- c("calories","water","duration","weight","bmi","height","fat")

# Fonction robuste pour corrélation
cor_mat_safe <- function(df) {
  df <- df[, intersect(vars_quant, names(df)), drop = FALSE]
  for (v in names(df)) df[[v]] <- suppressWarnings(as.numeric(df[[v]]))
  keep <- sapply(df, function(x) sum(!is.na(x)) >= 2 && sd(x, na.rm = TRUE) > 0)
  df <- df[, keep, drop = FALSE]
  if (ncol(df) < 2) return(NULL)
  cor(df, use = "pairwise.complete.obs", method = "pearson")
}

# Genres présents
genders <- unique(na.omit(SalleDeSport$gender))

# Boucle d'affichage
for (g in genders) {

  d <- SalleDeSport[SalleDeSport$gender == g, ]
  C <- cor_mat_safe(d)

  if (!is.null(C)) {
    corrplot(
      C,
      method = "ellipse",
      type = "full",
      addCoef.col = "black",
      tl.col = "black",
      tl.srt = 45,
      title = paste("Matrice de corrélation -", g),
      mar = c(0, 0, 2, 0)
    )
  }
}


```

On observe d'abord une corrélation positive entre le poids et la taille, les individus plus grands auraient tendance à être plus lourds. L'IMC, défini à partir du poids et de la taille, est logiquement très fortement corrélé au poids. En revanche, sa corrélation avec la taille apparaît faible et légèrement négative dans l'échantillon global. Lorsque l'analyse est menée séparément chez les hommes et les femmes, cette corrélation négative devient plus marquée, ce qui est plus cohérent avec la formule de calcul de l'IMC et suggère que l'effet de la taille est en partie masqué dans l'analyse globale. De plus, la corrélation entre poids et taille disparaît complètement lorsqu'on sépare hommes et femmes.

La relation entre la durée des séances et les calories brûlées est particulièrement forte, ce qui confirme que la dépense énergétique dépend avant tout du temps consacré à l'effort. La consommation d'eau est également positivement liée à la durée et aux calories, bien que de manière plus modérée, traduisant des comportements d'hydratation variables d'un individu à l'autre. Ces relations restent globalement stables lorsque l'on distingue les hommes et les femmes, ce qui indique des mécanismes communs indépendants du genre.

Le body-fat se distingue par des corrélations négatives marquées avec la durée des séances, les calories brûlées et la consommation d'eau. Cela suggère que les individus présentant un pourcentage de masse grasse plus élevé ont tendance à réaliser des séances plus courtes et moins intenses, accompagnées d'une hydratation plus faible. À l'inverse, les variables morphologiques telles que le poids et la taille ne sont pas liées aux indicateurs de performance sportive considérés ici. Cette dissociation indique que, dans ce jeu de données et avec ces variables, la morphologie seule n'explique pas directement les performances, qui semblent davantage dépendre de l'effort fourni et de la composition corporelle.

Enfin, il est étonnant de voir que le body fat n'est pas corrélé au poids ou à l'IMC. Cette variable n'augmente donc pas mécaniquement avec le poids, surtout dans une population sportive où la masse musculaire peut représenter une part importante du poids total. Cette observation avait déjà été faire lors de l'expérience super-size me. Le sujet n'avait pas prit beaucoup de poids mais était quand même devenu en très mauvaise santé, notamment à cause de son body-fat (et beaucoup d'autres troubles liés à la junk-food).















Un nuage de points générique calories vs duration coloré par genre permet de visualiser ces effets :

Rédaction
```{r}
ggplot(SalleDeSport, aes(x=duration, y=calories, color=gender)) +
geom_point(alpha=0.6) +
labs(title="Calories brûlées vs Durée de séance (couleur par genre)",
x="Durée (heures)", y="Calories") +
theme_minimal()
```

On s’attend à une relation (approx.) linéaire ascendante : plus la durée est grande, plus les calories sont élevées. Les points peuvent différer légèrement selon le genre (par exemple, les hommes peuvent brûler davantage de calories pour une même durée que les femmes, en raison de différences physiologiques). [À compléter : commenter l'aspect du nuage obtenu]

### Variables quantitatives en fonction de variables qualitatives

On compare les distributions des variables quantitatives selon les catégories de gender et de level à l’aide de boxplots.

Rédaction
Exemple : poids par genre et par niveau

ggplot(SalleDeSport, aes(x=gender, y=weight, fill=gender)) +
geom_boxplot() +
scale_fill_manual(values=c("#6BAED6","#FDB0C0")) +
labs(title="Poids par genre", x="Genre", y="Poids (kg)") +
theme_minimal() + theme(legend.position="none")

ggplot(SalleDeSport, aes(x=level, y=weight, fill=level)) +
geom_boxplot() +
scale_fill_brewer(palette="Greens") +
labs(title="Poids par niveau d'expérience", x="Niveau", y="Poids (kg)") +
theme_minimal() + theme(legend.position="none")

Il faudrait répéter ce genre de graphiques pour chaque variable quantitative (height, duration, calories, fat, water, bmi) en fonction de gender et de level. Ces boxplots révèlent, par exemple :

Par genre : on peut s'attendre à ce que la médiane du poids et de la taille soit plus élevée pour les hommes que pour les femmes. En revanche, la masse grasse (fat) est souvent plus élevée chez les femmes.

Par niveau : il peut être intéressant de voir si les niveaux d'expérience diffèrent en termes de durée de séance (peut-être les experts s'entraînent plus longtemps ou moins longtemps ?), ou en termes de calories brûlées.

[À compléter : pour chaque graphique, décrire les différences de médiane et d'étendue observées]

Association quantitatives vs qualitatives (Eta²)

Pour chaque variable quantitative, on calcule le rapport de corrélation η² vis-à-vis de chaque variable qualitative (gender et level) à l’aide de la fonction eta2() du package BioStatR.

Rédaction
if (!require(BioStatR)) install.packages("BioStatR")

library(BioStatR)
quanti_vars <- c("weight","height","duration","calories","fat","water","bmi")
eta_gender <- sapply(quanti_vars, function(v) eta2(SalleDeSport[[v]], SalleDeSport$gender))
eta_level <- sapply(quanti_vars, function(v) eta2(SalleDeSport[[v]], SalleDeSport$level))
eta_tab <- data.frame(Variable = quanti_vars, Eta2_Gender = eta_gender, Eta2_Level = eta_level)
print(eta_tab)

Le tableau obtenu donne, pour chaque variable quantitive, la part de variance expliquée par le genre ou par le niveau. Par exemple :

Une grande valeur de η² pour fat vs gender indiquerait que le pourcentage de masse grasse diffère significativement entre hommes et femmes (on s'y attend).

Une valeur élevée de η² pour duration vs level suggérerait que la durée moyenne de séance varie selon l'expérience (éventuellement les débutants s’entraînent moins longtemps que les experts, ou vice versa).

Des valeurs proches de 0 (pour water vs gender, par exemple) signifieraient une absence de lien fort.

[À compléter : interprésenter les valeurs spécifiques d'η² et en tirer des conclusions sur quelles relations sont fortes]

Variables qualitatives entre elles

Enfin, on examine l’association entre les deux variables qualitatives gender et level.

Rédaction
Table de contingence

tab_genre_niveau <- table(SalleDeSport$gender, SalleDeSport$level)
tab_genre_niveau
addmargins(tab_genre_niveau) # ajoute les totaux lignes/colonnes

Profils-lignes et profils-colonnes

prop.table(tab_genre_niveau, 1) # proportions par genre (lignes)
prop.table(tab_genre_niveau, 2) # proportions par niveau (colonnes)

Mosaic plot

mosaicplot(tab_genre_niveau, color=TRUE, main="Mosaic : Genre vs Niveau")

On obtient ainsi la table de contingence et les marges. Les profils-lignes (prop.table(...,1)) montrent la répartition proportionnelle des niveaux pour chaque genre : par exemple, chez les hommes, X% sont débutants, Y% intermédiaires, Z% experts. Les profils-colonnes (prop.table(...,2)) indiquent la proportion d'hommes et de femmes parmi les débutants, etc. Le mosaic plot met en évidence visuellement ces proportions.

[À compléter : commenter les résultats. Par exemple, si la proportion d'hommes est plus grande parmi les experts que parmi les débutants, cela se traduirait par un décalage visible. Sinon, on constate une répartition uniforme, etc.]

Conclusion partielle

En résumé, cette analyse descriptive montre les caractéristiques principales du jeu de données DataGym3MIC. La plupart des variables quantitatives ont une distribution unimodale sans valeurs aberrantes majeures. On observe des différences attendues entre les genres (par exemple poids/taille supérieurs chez les hommes, pourcentage de graisse supérieur chez les femmes). Le niveau d'expérience semble également associé à certaines variables d'entraînement (à détailler). Les représentations graphiques (histogrammes, boxplots, nuages de points, mosaic plots) sont adaptées pour visualiser ces distributions et relations.

La suite du rapport pourra compléter l'interprétation détaillée de chaque graphique produit, ainsi que l'exploration de relations plus fines entre les variables (test d'indépendance entre qualitatives, analyse de covariance, etc.). Chaque choix de représentation a été justifié par le type de variable et l'intérêt d'illustrer visuellement la distribution ou la relation étudiée.





























Ces graphiques (à exécuter) montreront la répartition : par exemple, si les hommes représentent 55% et les femmes 45% de l'échantillon, ou si 50% sont débutants, 30% intermédiaires, 20% experts. [À compléter : indiquer les pourcentages exacts et observations principales sur ces distributions]

# Analyse en composantes principales/multidimentionnelle

On fait quelques geom plot pour commencer a essayer d'observer des trucs dans e jeu de données :

```{r}
ggplot(data=SalleDeSport)+
   geom_point(aes(x=weight,y=height,color=fat))

# Histogramme
ggplot(SalleDeSport, aes(x=calories)) +
  geom_histogram(bins=30, fill="steelblue", alpha=0.7) +
  labs(title="Distribution des calories brûlées", x="Calories", y="Fréquence")

# Boxplot par niveau
ggplot(SalleDeSport, aes(x=factor(level), y=duration, fill=factor(level))) +
  geom_boxplot() +
  labs(title="Durée des séances par niveau", x="Niveau", y="Durée (heures)")

# Nuage de points
ggplot(SalleDeSport, aes(x=duration, y=calories, color=gender)) +
  geom_point(alpha=0.6) +
  labs(title="Calories brûlées vs Durée de séance", x="Durée (heures)", y="Calories")


```




rerésenter chaque variable quantative en fonction de chaque variable qualitative (genre et niveau) (dans des boxplot colorés de maniere coherente) faire la matrice de correlation pour toutes les variables qualitatives explorer les differentes combinaisons afin de determiner les variables fortement liées et inversement

A l'aide de la fonction `eta2()` de la librairie `BioStatR`, calculez le rapport de corrélation $\eta^2$ entre chaque variable quantitative et chaque variable qualitative. Commentez.(toutes les combinaisons)


**Question :** Analysez la table de contingence entre les deux variables qualitatives **Type** et **Qualite** avec la commande `table()`. Ajoutez les effectifs marginaux avec la commande `addmargins()`.

```{r}
# A COMPLETER
```

**Question :** Calculez et représentez les profils-lignes à l'aide des fonctions `prop.table(..., margin = ...)` et `mosaicplot`. Interprétez les résultats. Faites de même avec les profils-colonnes.

```{r}
# A COMPLETER
```

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
1 + 1
```

You can add options to executable code like this

```{r}
#| echo: false
#| eval: false
2 * 2
```

The `echo: false` option disables the printing of code (only output is displayed).
